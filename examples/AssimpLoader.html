<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <style>
        body {
            margin: 0px;
            background-color: #000000;
            overflow: hidden;
        }
    </style>
</head>
<body>
<canvas id="render_canvas"></canvas>

<script src = "../libs/three.js" type = "text/javascript"></script>
<script src = "../bin/bundle.min.js" type="text/javascript"></script>
<script src = "../libs/OrbitControls.js" type = "text/javascript"></script>

<script>


    var renderer = null;
    var scene,camera ,renderTarget1,renderTarget2,scene1;
    var screen;
    init();

    animate();

    function init(){
        testModels();
    }

    function animate() {
        requestAnimationFrame(animate);

        renderer.render(scene,camera,renderTarget1);

        renderer.render(scene1,camera,null);

        var temp = renderTarget1;
        renderTarget1 = renderTarget2;
        renderTarget2 = temp;
        screen.material.diffuse = renderTarget1.texture;
    }

    function testModels(){

        var  canvas = document.getElementById("render_canvas") ;
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        renderTarget1 = new HEY.WGLRenderTarget(canvas.width,canvas.height);
        renderTarget2 = new HEY.WGLRenderTarget(canvas.width,canvas.height);

        renderer = new HEY.WebGL2Renderer({canvas:canvas,antialias:true});

        scene = new HEY.Scene();
        scene1 = new HEY.Scene();

        camera = new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,0.1,10000);
        camera.position.z = 20;
        camera.position.y = 8;


        var assimpLoader = new HEY.AssimpJSONLoader();
        assimpLoader.load("../asset/nanosuit/nanosuit.json",function(obj){
            obj.transform.scale.set(2,2,2);
            obj.transform.postition.y = -15;

            scene.add(obj);
        });

        var rect = new HEY.GeometryBuffer();
        rect.addAttribute("position",new HEY.VertexAttribute([-1,1,-1,-1,1,1,1,-1],2,HEY.FLOAT));
        rect.setIndex([0,1,3,0,3,2]);

        var material = new HEY.ShaderMaterial(HEY.ShaderLib.v_screen,HEY.ShaderLib.f_screen,{
            diffuse:renderTarget1.texture
        });

        screen = new HEY.Mesh(rect,material);
        scene1.add(screen);

        var rect1 = new HEY.GeometryBuffer();
        rect1.addAttribute("position",new HEY.VertexAttribute([-1,1,-1,-1,1,1,1,-1],2,HEY.FLOAT));
        rect1.setIndex([0,1,3,0,3,2]);
        var material1 = new HEY.ShaderMaterial(HEY.ShaderLib.v_screen,HEY.ShaderLib.f_screen,{
        });
        var screen1 = new HEY.Mesh(rect1,material1);
//        scene.add(screen1);

        var controls = new THREE.OrbitControls( camera, renderer.domElement );
        controls.maxPolarAngle = Math.PI * 0.5;
        controls.minDistance = 10;
        controls.maxDistance = 7500;

    }

</script>

</body>
</html>